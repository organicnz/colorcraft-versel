# SQL Files Organization

This directory contains all SQL files for the ColorCraft furniture painting website, organized by purpose and functionality.

## Directory Structure

### üìÅ `/scripts/` - Setup & Configuration Scripts
Contains SQL scripts for initial setup, configuration, and one-time operations:

- `always-refresh-trigger.sql` - Always refresh portfolio images trigger
- `create-directories-only.sql` - Create storage directories without content
- `force-refresh-after-upload.sql` - Force refresh after image upload
- `manual-storage-setup.sql` - Manual Supabase storage bucket setup
- `manual-trigger-update.sql` - Manual trigger updates
- `portfolio-storage-setup.sql` - Portfolio storage configuration
- `setup-cron-job.sql` - Cron job setup for automated tasks
- `update-cron-schedule.sql` - Update cron scheduling

### üìÅ `/utilities/` - Debug & Utility Scripts
Contains diagnostic and utility SQL scripts:

- `debug-storage-structure.sql` - Debug storage bucket structure

### üìÅ `/drizzle/` - Drizzle ORM Migrations
Contains migrations from Drizzle ORM:

- `0000_wooden_scarlet_witch.sql` - Initial Drizzle migration

### üìÅ `/archive/` - Historical Files
Contains archived SQL files and version history:

- `.history/` - Complete history of SQL file changes and versions

## External SQL Locations

### Supabase Migrations (Kept in Original Location)
Location: `/supabase/migrations/`
- Contains official Supabase database migrations
- Follows Supabase CLI naming conventions
- Automatically managed by Supabase migration system

### Schema Files
- `/supabase/schema.sql` - Main database schema

## Usage Guidelines

### For Setup Scripts
1. Review script purpose and dependencies
2. Test in development environment first
3. Execute with appropriate Supabase credentials
4. Monitor execution for errors

### For Utilities
1. Use for debugging and diagnostics
2. Safe to run in any environment
3. Primarily read-only operations

### For Migrations
1. Drizzle migrations should be run via Drizzle CLI
2. Supabase migrations should be run via Supabase CLI
3. Never modify migration files after they've been applied

## File Naming Conventions

- **Scripts**: Descriptive names with hyphens (kebab-case)
- **Supabase Migrations**: Timestamp + descriptive name
- **Drizzle Migrations**: Auto-generated by Drizzle CLI
- **Utilities**: Prefixed with purpose (debug-, test-, etc.)

## Best Practices

1. **Always backup** before running setup scripts
2. **Test in development** before production deployment
3. **Document changes** when modifying scripts
4. **Version control** all SQL file changes
5. **Use transactions** for multi-statement operations

## Related Documentation

- [Supabase CLI Documentation](https://supabase.com/docs/reference/cli)
- [Drizzle ORM Migrations](https://orm.drizzle.team/kit-docs/overview)
- [PostgreSQL Documentation](https://www.postgresql.org/docs/)

---

*Last Updated: June 10, 2025*
*Project: ColorCraft Furniture Painting Website* 